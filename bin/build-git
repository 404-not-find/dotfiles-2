#!/bin/sh

# avoid "Document /<path>/git/Documentation/git-add.xml does not validate" errors
export XML_CATALOG_FILES=/usr/local/etc/xml/catalog
export CPPFLAGS=-I/usr/local/opt/openssl/include
export LDFLAGS=-L/usr/local/opt/openssl/lib

cd /data/repo/git

if git pull | grep 'Already up-to-date.' && [[ $1 != '-f' ]]; then
    exit 0
fi

make distclean 1>/dev/null
make configure 1>/dev/null
./configure --prefix=$HOME/local/git && make install install-man
